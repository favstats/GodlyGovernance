(function(){var TWP=window.TWP||{};TWP.Perso=TWP.Perso||{};TWP.Perso.Tools=TWP.Perso.Tools||{};var T=TWP.Perso.Tools;var $=jQuery;var $body=$("body");var $window=$(window);var $document=$(document);T.Obj={read:function(o,key){if(typeof key!="string"||key==="")return o;var val=o;var prop=null;var keys=key.split(".");for(var i=0;i<keys.length;i++){prop=keys[i];if(prop&&prop!==""&&val!==null)if(val&&val!==null&&typeof val=="object"&&val.hasOwnProperty(prop))val=val[prop];else val=null}return val}};var _store=
{};T.store={getJSONItem:function(key,path){if(window.localStorage&&window.localStorage.getItem&&window.JSON&&window.JSON.parse){var val=window.localStorage.getItem(key);if(typeof val=="string"&&val!=="")return T.Obj.read(JSON.parse(val),path);else return val}else return T.Obj.read(_store[key],path)},setJSONItem:function(key,val){if(window.localStorage&&window.localStorage.setItem)if(typeof value=="string")window.localStorage.setItem(key,val);else if(window.JSON&&window.JSON.stringify)window.localStorage.setItem(key,
JSON.stringify(val));else window.localStorage.setItem(key,val);else _store[key]=val}};T.store.getItem=T.store.getJSONItem;T.store.setItem=T.store.setJSONItem;T.SVI={get:function(){return document.cookie.match(/s_vi=([^;]+)/)?RegExp.$1:""},getHex:function(){var svi=T.SVI.get();if(svi&&svi!==""){svi=svi.replace(/.*\|/,"").replace(/\[.*/,"").split("-");svi=svi[0]+"-"+svi[1]}return svi}};T.Omniture={exists:function(){return!!(window.s&&window.s.sendDataToOmniture)},send:function(a,b,c,log){var extra=
"";if(T.Omniture.exists()){if(window.JSON&&window.JSON.stringify){extra=" / evars: "+JSON.stringify(b);extra=" / props: "+JSON.stringify(c)}if(log)log.debug("Omniture tracking : "+a+extra);window.s.sendDataToOmniture(a,b,c)}else log.debug("Omniture failure : "+a+extra)}};var TEventsListeners={};T.Events={smartPreload:function(elem,options){if(elem&&TEventsListeners[elem])$window.off("scroll",TEventsListeners[elem]);if(!(options.visible||options.preload))return;var preloadCalled=false;var visibleCalled=
false;var screens=options&&options.screens||1;if(!(elem instanceof jQuery))elem=$(elem);var callback=function(){var offset=elem.offset().top;var scrollPos=$body.scrollTop();var windowHeight=window.innerHeight;if(scrollPos===0)scrollPos=$document.scrollTop();var diff=offset-(scrollPos+windowHeight);var size=window.innerHeight*screens;if(window.innerWidth<768)size=size*2;if(diff<size)if(options.preload&&!preloadCalled){preloadCalled=true;options.preload()}if(diff<0){if(options.visible&&!visibleCalled){visibleCalled=
true;options.visible()}$window.off("scroll",callback)}};$window.on("scroll",callback);TEventsListeners[elem]=callback;callback()}};T.noticeError=function(app,error,context){}})();